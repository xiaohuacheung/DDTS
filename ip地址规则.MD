
# IPv4

网际协议版本4（英语：InternetProtocolversion4，IPv4），又称互联网通信协议第四版，是网际协议开发过程中的第四个修订版本，也是此协议第一个被广泛部署的版本。IPv4是互联网的核心，也是使用最广泛的网际协议版本，其后继版本为IPv6，直到2011年，IANAIPv4位址完全用尽时，IPv6仍处在部署的初期。
IPv4在IETF于1981年9月发布的RFC 791中被描述，此RFC替换了于1980年1月发布的RFC 760。
## 特殊用途的地址

| CIDR地址块 | 描述 | 参考资料 |
| --- | ---| --- |
| 0.0.0.0/8 | 本网络（仅作为源地址时合法）| RFC 5735 |
| 10.0.0.0/8 | 专用网络 | RFC 1918 |
| 100.64.0.0/10| 电信级NAT| RFC 6598|
| 127.0.0.0/8| 环回| RFC 5735|
| 169.254.0.0/16| 链路本地| RFC 3927|
| 172.16.0.0/12| 专用网络| RFC 1918|
| 192.0.0.0/24| 保留（IANA）| RFC 5735|
| 192.0.2.0/24| TEST-NET-1，文档和示例| RFC 5735|
| 192.88.99.0/24| 6to4中继| RFC 3068|
| 192.168.0.0/16| 专用网络| RFC 1918|
| 198.18.0.0/15| 网络基准测试| RFC 2544|
| 198.51.100.0/24| TEST-NET-2，文档和示例| RFC 5737|
| 203.0.113.0/24| TEST-NET-3，文档和示例| RFC 5737|
| 224.0.0.0/4| 多播（之前的D类网络）| RFC 3171|
| 240.0.0.0/4| 保留（之前的E类网络）| RFC 1700 |
| 255.255.255.255| 受限广播| RFC 919| 

## 专用网络

在IPv4所允许的大约四十亿地址中，三个地址块被保留作专用网络。这些地址块在专用网络之外不可路由，专用网络之内的主机也不能直接与公共网络通信。但通过网络地址转换（NAT），使用这些地址的主机可以像拥有共有地址的主机在互联网上通信。
下表展示了三个被保留作专用网络的地址块（RFC 1918）：

| 名字 | 地址范围 | 地址数量 | 有类别的描述 | 最大的CIDR地址块 |
| --- | ---| --- |---| --- |
| 24位块 | 10.0.0.0–10.255.255.255| 16,777,216| 一个A类| 10.0.0.0/8|
|20位块|172.16.0.0–172.31.255.255|1,048,576|连续的16个B类|172.16.0.0/12|
|16位块|192.168.0.0–192.168.255.255|65,536|连续的256个C类|192.168.0.0/16|

## 虚拟专用网络
通常情况下，路由器根据数据报文的目的地址决定转发数据报文的下一跳地址。使用专用网络地址作为目的地址的数据包通常无法被公共路由器正确送达，因为公共路由器没有相应的路由信息，即无法得知如何才能转发到该IP地址。因此，这就需要通过一种方法，将指引数据报文转发的下一跳地址和真正要传输的目的地址分离开。于是就使用虚拟专用网，将IP报文封装在其他报文内，以便于通过公网上的公共路由器，达到能处理该报文内层数据的网络设备上解除报文后，该数据包可以被继续转发到目的地址。
将数据报文封装的过程中，可以将数据报文封装于IP报文中，也可以使用多协议标签交换协议等，通过其他协议引导数据报文转发。也可以封装同时加密数据，以保护数据内容。

## 链路本地地址

RFC 5735中将地址块169.254.0.0/16保留为特殊用于链路本地地址，这些地址仅在链路上有效（如一段本地网络或一个端到端连接）。这些地址与专用网络地址一样不可路由，也不可作为公共网络上报文的源或目的地址。链路本地地址主要被用于地址自动配置：当主机不能从DHCP服务器处获得IP地址时，它会用这种方法生成一个。
当这个地址块最初被保留时，地址自动配置尚没有一个标准。为了填补这个空白，微软创建了一种叫自动专用IP寻址（APIPA）的实现。因微软的市场影响力，APIPA已经被部署到了几百万机器上，也因此成为了事实上的工业标准。许多年后，IETF为此定义了一份正式的标准：RFC 3927，命名为“IPv4链路本地地址的动态配置”。
## 环回地址 
地址块127.0.0.0/8被保留作环回通信用。此范围中的地址绝不应出现于主机之外，发送至此地址的报文被作为同一虚拟网络设备上的入站报文（环回），主要用于检查TCP/IP协议栈是否正确运行和本机对本机的链接。
##  以0或255结尾的地址
一个常见的误解是以0或255结尾的地址永远不能分配给主机：这仅在子网掩码至少24位长度时（旧的C类地址，或CIDR中的/24到/32）才成立。
在有类别的编址中，只有三种可能的子网掩码：A类：255.0.0.0，B类：255.255.0.0，C类：255.255.255.0。如，在子网192.168.5.0/255.255.255.0（即192.168.5.0/24）中，网上识别码192.168.5.0用来表示整个子网，所以它不能用来标识子网上的某个特定主机。
广播地址允许数据包发往子网上的所有设备。一般情况下，广播地址是借由子网掩码的比特反码并和网上识别码运行 OR 的比特运算得到，即广播地址是子网中的最后一个地址。在上述例子中，广播地址是192.168.5.255，所以为了避免歧义，这个地址也不能被分配给主机。在A、B和C类网络中，广播地址总是以255结尾。
但是，这并不意味着每个以255结尾的地址都不能用做主机地址。比如，在B类子网192.168.0.0/255.255.0.0（即192.168.0.0/16）中，广播地址是192.168.255.255（主机位全1）。在这种情况下，尽管可能带来误解，但192.168.1.255、192.168.2.255等地址可以被分配给主机。同理，192.168.0.0作为网上识别码不能被分配，但192.168.1.0、192.168.2.0等都是可以的。
随着CIDR的到来，广播地址不一定总是以255结尾（广播地址是指主机位都为1的地址，255只是其中一种情况）。比如，子网203.0.113.16/28的广播地址是203.0.113.31。过程如下：
网络：203.0.113.16
掩码：255.255.255.240
掩码反码：0.0.0.15
OR操作：
00010000 | 00001111 = 00011111 =31
一般情况下，子网的第一个和最后一个地址分别被作为网上识别码和广播地址，任何其它地址都可以被分配给其上的主机。
##  地址解析 
互联网上的主机通常被指定，但IP报文的路由是由IP地址而不是这些名字决定的。这就需要将域名翻译（解析）成地址。
域名系统（DNS）提供了域名转换为IP地址的服务。与CIDR相像，DNS是层级结构。

# IPv6

IPv6是英文“Internet Protocol Version 6”（互联网协议第6版）的缩写，是用于替代IPv4的下一代IP协议，也就是下一代互联网的协议。

IPv6的使用，不仅能解决网络地址资源数量的问题，而且也解决了多种接入设备连入互联网的障碍。其128位地址格式将以其在IP地址数量、安全性、移动性、服务质量等方面的巨大优势，改变现代信息生活。

互联网数字分配机构（IANA）在2016年已向国际互联网工程任务组（IETF）提出建议，要求新制定的国际互联网标准只支持IPv6，不再兼容IPv4。

IP地址（IPV4）由32位正整数来表示，IP地址在计算机中是以二进制的方式处理，但为了方便记忆采用点十进制的标记方式（8位为一组，分四组，每一组都转换为十进制），与IPv4相比IPv6采用128位的地址，而IPv4使用的是32位。因此新增的地址空间支持2^128 个地址，具体数量为340,282,366,920,938,463,463,374,607,431,768,211,456个有人说IPv6的地址数可能比全世界的沙子还要多，足以解决目前IPv4地址量不足的问题。IPv6二进位制下为128位长度，以16位为一组，每组以冒号“:”隔开，可以分为8组


## Ipv6中的兼容地址有哪些?

 ● IPv4兼容地址:用于双栈主机使用IPv6进行通信,因此需要将IPv4地址表示成IPv6的形式。格式为`0:0:0:0:0:0:w.x.y.z`,也可以表示为`:: w.x.y.z,其中w.x.y.z`为IPv4地址。
 ● IPv4映射地址:为了方便IPv6网络节点区分IPv4网络中的节点,设计了该地址,其格式为`0:0:0:0:0:FFFF: w.x.y.z`,也可以表示为`::FFFF:w.x.y.z`。
 ● 6to4地址:当IPv6网络中的数据包要通过IPv4网络传递时,需要将地址表示为该地址类型。
 ● 6over4地址:用于6over4隧道技术的地址,其格式为`[64-bits Prefix]:0:0:wwxx:yyzz`。其中`wwxx:yyzz`是十进制IPv4地址`w.x.y.z`的IPv6格式。
 ● ISATAP地址:用于ISATAP隧道技术的地址,其格式为`[64-bits Prefix]:0:5EFE:w.x.y.z。w.x.y.z`是十进制IPv4地址。